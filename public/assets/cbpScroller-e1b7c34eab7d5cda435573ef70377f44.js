/**
 * cbpScroller.js v1.0.0
 * http://www.codrops.com
 *
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * Copyright 2013, Codrops
 * http://www.codrops.com
 */
!function(window){"use strict";function getViewportH(){var client=docElem.clientHeight,inner=window.innerHeight;return inner>client?inner:client}function scrollY(){return window.pageYOffset||docElem.scrollTop}function getOffset(el){var offsetTop=0,offsetLeft=0;do isNaN(el.offsetTop)||(offsetTop+=el.offsetTop),isNaN(el.offsetLeft)||(offsetLeft+=el.offsetLeft);while(el=el.offsetParent);return{top:offsetTop,left:offsetLeft}}function inViewport(el,h){var elH=el.offsetHeight,scrolled=scrollY(),viewed=scrolled+getViewportH(),elTop=getOffset(el).top,elBottom=elTop+elH,h=h||0;return viewed>=elTop+elH*h&&elBottom>=scrolled}function extend(a,b){for(var key in b)b.hasOwnProperty(key)&&(a[key]=b[key]);return a}function cbpScroller(el,options){this.el=el,this.options=extend(this.defaults,options),this._init()}var docElem=window.document.documentElement;cbpScroller.prototype={defaults:{viewportFactor:.2},_init:function(){if(!Modernizr.touch){this.sections=Array.prototype.slice.call(this.el.querySelectorAll(".cbp-so-section")),this.didScroll=!1;var self=this;this.sections.forEach(function(el){inViewport(el)||classie.add(el,"cbp-so-init")});var scrollHandler=function(){self.didScroll||(self.didScroll=!0,setTimeout(function(){self._scrollPage()},60))},resizeHandler=function(){function delayed(){self._scrollPage(),self.resizeTimeout=null}self.resizeTimeout&&clearTimeout(self.resizeTimeout),self.resizeTimeout=setTimeout(delayed,200)};window.addEventListener("scroll",scrollHandler,!1),window.addEventListener("resize",resizeHandler,!1)}},_scrollPage:function(){var self=this;this.sections.forEach(function(el){inViewport(el,self.options.viewportFactor)?classie.add(el,"cbp-so-animate"):(classie.add(el,"cbp-so-init"),classie.remove(el,"cbp-so-animate"))}),this.didScroll=!1}},window.cbpScroller=cbpScroller}(window);